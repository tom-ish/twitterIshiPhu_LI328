<!-- JQUERY -->
<!-- document html // pour charger la bibliotheque JQUERY -->
<!DOCTYPE html>
<html>
	<head>
		<meta charset="US-ASCII"/>
		<script src = "http://code.jquery.com/jquery-latest.js"></script>
		<script>
		<!-- Q1] A utiliser dans verif_formulaire de la semaine derniere a la place de alert():  --> 
		function func_error(msg){
			var msg_box = "<div id = \"msg_err_connexion\">" + msg + "<\div>"
			var old_msg = $("#msg_err_connexion");
			if(old_msg.length == 0){
				$("form").prepend(msg_box);
			}
			else{
				old_msg.replaceWith(msg_box);
			}
			$("#msg_err_connexion").css(
			{
				"padding-top": "0px",
				"padding-bottom": "0px",
				"color": "red",
				"word-wrap": "break-word"
			});
		}

		<!-- Q2] main.html -->
		// Suppose que la variable environnement existe (cree dans main)
		function gererDivConnexion(){
			var user = environnement.actif;
			if((user != undefined) && (user.login != "")){ // il y a un user connecte
				$("#conenrlog").html("<span id = \"log\">" + user.login + "</span>");
				$("#log").css("margin-right", "10px");
				$("#disconnect").css("visibility", "visible");
			}
			else {
				$("#conenrlog").html(
					<a href = "connexion.html" id = "connexion_link">Connexion</a>
					<a href = "enregistrement.html" id = "enegistrement">Enregistrement</a>)
				$("#disconnect").css("visibility", "hidden");
			}
		}
		
		<!-- Q3] Affichage commentaires -->
		RechercheCommentaires.traiteResponseJSON = function(json_txt){
			var old_users = environnement.users;	// ???
			environnement.users = [];	// ???
			var obj = JSON.parse(json_txt, RechercheCommentaires.revival);
			if(obj.erreur == undefined){
				$("#main").html(obj.getHtml());
			}
			else	// alert probleme serveur ou BD
				environnement.users = old_users;	// ???
		}
		
		function disconnect(){
			console.log("Deconnexion");
			envrionnement.actif = undefined;
			gererDivConnexion();
			var json_txt = envoiCommentaires();
			RechercheCommentaires.traiteResponseJSON(json_txt);
		}
		
		function main(){
			environnement = new Object();
			environnement.users = [];
			environnement.acitf = new User(4, "Toto');
			gererDivConnexion();
			$("#disconnect").click(disconnect);
			var json_txt = envoiCommentaire();
			RechercheCommentaires.traiteResponseJSON(json_txt);
		}
		</script>
	</head>
	<body>
			
		<!-- Q2] main.html -->
		<div id = "connect">
			<span id = "conenrlog">
				<a href = "connexion.html" id = "connexion_link">Connexion</a>
				<a href = "enregistrement.html" id = "enegistrement">Enregistrement</a>
			</span>
		</div>
	</body>
</html>
